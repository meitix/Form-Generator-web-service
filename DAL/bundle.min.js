(function(n){var i=require("./repository-base"),r=require("mongodb"),t="forms";n.getFormById=function(n,u){i.getDatabase(function(i,f){if(f)u(f,null);else{var e=new r.ObjectID(n);i.collection(t).find({_id:e}).toArray(function(n,t){u(n,t[0])})}})};n.getAll=function(n){i.getDatabase(function(i,r){if(r)n(null,r);else var u=i.collection(t).find().sort({_id:-1}).toArray(function(t,i){n(i,t)})})};n.addForm=function(n,u){i.getDatabase(function(i,f){f?(console.log(f),u(f,null,n)):n._id?(n._id=new r.ObjectID(n._id),i.collection(t).update({_id:n._id},n,function(t){u(f,t,n)})):(delete n._id,i.collection(t).insertOne(n,function(t){u(f,t,n)}))})};n.addManyForms=function(n,r){i.getDatabase(function(i,u){u?(console.log(u),r(u,null,n)):i.collection(t).insertMany(n).then(function(t){r(u,t,n)})})};n.delete=function(n,u){i.getDatabase(function(i,f){if(f)console.log(f),u(f);else{var e=new r.ObjectID(n);i.collection(t).deleteOne({_id:e},function(n){u(n)})}})};n.addformResult=function(n,u,f){i.getDatabase(function(i,e){if(e)f(e,null),console.log(e);else{var o=new r.ObjectID(n);i.collection(t).find({_id:o}).toArray(function(n,e){if(n)f(n,null);else if(u._id){var s=new r.ObjectID(u._id);u._id=s;i.collection(t).updateOne({"results._id":s},{$set:{"results.$":u}},f)}else e=e[0],u._id=new r.ObjectID,e.results=e.results||[],e.results.push(u),delete e._id,i.collection(t).updateOne({_id:o},e,function(n,t){n?f(n,null):f(null,t)})})}})};n.getFormsByIds=function(n,r){i.getDatabase(function(i,u){u?(console.log(u),r(u)):i.collection(t).find({_id:{$in:n}}).toArray(r)})};n.deleteFormResult=function(n,u){i.getDatabase(function(i,f){if(f)console.log(f),u(f);else{var e=new r.ObjectID(n.resultId),o=new r.ObjectID(n.formId);i.collection(t).update({_id:o},{$pull:{results:{_id:e}}},u)}})}})(module.exports)(function(n){var i=require("mongodb"),r="mongodb://localhost:27017/TadFormGenerator",t=null;n.getDatabase=function(n){t?n(t,null):i.MongoClient.connect(r,function(i,r){i?n(null,i):(t=r,n(r,null))})}})(module.exports)(function(n){var t=require("./repository-base"),r=require("mongodb"),i="users";n.createUser=function(n,r){t.getDatabase(function(t,u){u?r(u,null):t.collection(i).insertOne(n,r)})};n.isExists=function(n,r){t.getDatabase(function(t,u){u?(r(u,null),console.log(u)):t.collection(i).findOne({username:n},function(n,t){r(n,t)})})};n.getUserByCondition=function(n,r){t.getDatabase(function(t,u){u?(r(u,null),console.log(u)):t.collection(i).findOne(n,r)})};n.getManyUsersByCondition=function(n,r,u){t.getDatabase(function(t,f){f?(u(f,null),console.log(f)):t.collection(i).find(n,r).toArray(u)})};n.getAllUsers=function(n){t.getDatabase(function(t,r){r?(n(r,null),console.log(r)):t.collection(i).find().toArray(n)})};n.getById=function(n,u){t.getDatabase(function(t,f){if(f)u(f,null),console.log(f);else{var e=new r.ObjectID(n);t.collection(i).findOne({_id:e},u)}})};n.update=function(n,u){t.getDatabase(function(t,f){if(f)u(f,null),console.log(f);else{var e=null;e=n._id._bsontype?n._id:new r.ObjectID(n._id);t.collection(i).updateOne({_id:e},n,u)}})}})(module.exports);